## 基于 PyTorch 的 CenterNet 目标检测算法实现
---
这是基于 PyTorch 实现的一个简易版 CenterNet。
注：并不是全部按 CenterNet 原文的做的，有些部分做了修改，我的网络是基于resnet+fpn的，fpn最后没有输出3个分支，只是输出了最后一个。backbone 部分可以修改为别的主流网络试试。
另外， dataset 部分浪费了很多显存，主要是xywh的gt部分，有很多无用的信息，可以参考其他的 CenterNet 实现，建议[https://github.com/ZeroE04/R-CenterNet](https://github.com/ZeroE04/R-CenterNet)的 dataset 部分，写的很清晰，由于我个人比较懒，就不想改了。
整体的代码为了能方便阅读，都尽量写得简洁明了。
### 目录
1. [训练步骤与使用方法](#训练步骤与使用方法)
2. [show检测的结果](#show检测的结果)


### 训练步骤与使用方法
#### a. [label.txt](./label.txt) 里是训练数据文件示例。一行文本就是一个图片的数据信息。每一行文本诸如以下形式，其中classes_idx是从0开始的：
```
path/to/image.jpg x1,y1,x2,y2,classes_idx;x1,y1,x2,y2,classes_idx;...
```
比如
```
data/1.jpg:0.2708333333333333,0.4146551724137931,0.5930555555555556,0.4844827586206897,0
data/2.jpg:0.3388888888888889,0.42586206896551726,0.6944444444444444,0.5094827586206897,0
data/3.jpg:0.31805555555555554,0.421551724137931,0.6361111111111111,0.4939655172413793,0
data/4.jpg:0.2763888888888889,0.35086206896551725,0.5958333333333333,0.4086206896551724,0
data/5.jpg:0.5,0.41293103448275864,0.8875,0.4818965517241379,0
data/6.jpg:0.26944444444444443,0.43103448275862066,0.6375,0.5172413793103449,0
data/7.jpg:0.29583333333333334,0.4862068965517241,0.7111111111111111,0.5724137931034483,0
data/8.jpg:0.29583333333333334,0.3913793103448276,0.6069444444444444,0.4681034482758621,0
data/9.jpg:0.29444444444444445,0.41724137931034483,0.6875,0.5043103448275862,0
```

#### b. 训练。
运行 [train.sh](./train.shy)
关于训练中的一些参数，比如batch_size、lr之类的，可以在[main_train.py](./main_train.py)中设置与更改。

### show检测的结果
运行 [infer.py](./infer.py)。
```
python infer.py
```
